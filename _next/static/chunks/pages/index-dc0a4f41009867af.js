(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(4293)}])},1641:function(e,n,r){"use strict";r.d(n,{Ar:function(){return i}});var t=r(5893),a=r(9008),o=r(5830);function c(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}var i=function(e){var n=e.state,r=e.onSelect,i=e.currentPlayerId,l=e.selectedCard,d=e.onDiscard,f=e.onDraw,p=e.onPlay,v=null===n||void 0===n?void 0:n.players.findIndex((function(e){return e.id===i})),m=null===n||void 0===n?void 0:n.players[v],h=(null===n||void 0===n?void 0:n.playerIndex)===v;return n&&m?(0,t.jsxs)("main",{children:[(0,t.jsxs)(a.default,{children:[(0,t.jsx)("title",{children:"Card game"}),(0,t.jsx)("meta",{name:"description",content:"Card game"}),(0,t.jsx)("link",{rel:"icon",href:"/online-keltis/favicon.ico"})]}),n.players.map((function(e,n){return function(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){c(e,n,r[n])}))}return e}({},e,{index:n})})).filter((function(e){return e.id!==i})).map((function(e,r){return(0,t.jsxs)("div",{className:"player my-2 ".concat(r===n.playerIndex?"active":""),children:[(0,t.jsx)("p",{children:e.name}),(0,t.jsx)(s,{piles:e.piles},r)]},r)})),(0,t.jsxs)("div",{className:"order-last space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"You"}),(0,t.jsx)("div",{children:(0,t.jsx)(s,{piles:m.piles})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Discard"}),(0,t.jsx)("div",{className:"flex space-x-2 h-20",children:(0,o.Z5)(n.discards).map((function(e,n){return(0,t.jsx)(u,{onClick:f,spread:!1,cards:e},n)}))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Your Hand"}),(0,t.jsx)(u,{selected:l,onClick:r,cards:m.hand})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Actions"}),(0,t.jsxs)("div",{className:"flex space-x-2 h-20",children:[0===n.phaseIndex?null:(0,t.jsx)("button",{disabled:!h,onClick:function(){return f()},children:"draw"}),1!==n.phaseIndex&&l?(0,t.jsx)("button",{disabled:!h,onClick:function(){return d()},children:"discard"}):null,1!==n.phaseIndex&&l?(0,t.jsx)("button",{disabled:!h,onClick:function(){return p()},children:"play"}):null]})]})]})]}):null},u=function(e){var n=e.cards,r=e.onClick,a=e.selected,c=e.spread,i=void 0===c||c?n:n.slice(n.length-1,n.length);return(0,t.jsx)("div",{className:"cards-wrapper",children:i.map((function(e,n){return(0,t.jsxs)("div",{className:"card ".concat(a===e?"selected":""),onClick:r?function(){return r(e)}:void 0,children:[(0,t.jsx)("span",{children:o.ZC[e.value]}),(0,t.jsx)("div",{className:"".concat(l[e.suit])})]},n)}))})},s=function(e){var n=e.piles;return(0,t.jsx)("div",{children:(0,o.Z5)(n).map((function(e,n){return(0,t.jsx)(u,{cards:e},n)}))})},l=["bg-suit-0","bg-suit-1","bg-suit-2","bg-suit-3","bg-suit-4","bg-suit-5"]},5830:function(e,n,r){"use strict";r.d(n,{ZC:function(){return f},aY:function(){return v},Lq:function(){return m},tv:function(){return h},l4:function(){return y},Oq:function(){return x},Z5:function(){return b},oY:function(){return I}});var t=r(6486),a=r(9983),o=r.n(a);function c(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function i(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){i(e,n,r[n])}))}return e}function s(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return c(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=[0,1,2,3,3,4,4,5,5,6,6,7,7,8,9,10,11,11],d=[0,1,2,3,4,5,6,7,8,9],f=["0","1","2","3","4","5","6","7","8","9","X","E"],p=s([0,1,2,3,4].map((function(e){return l.map((function(n){return{suit:e,value:n}}))})).flat()).concat(s([0,1,2,3,4,5,6,7,8,9,10].map((function(e){return{suit:5,value:e}})))),v=function(){var e=o()(p),n=(d.map((function(e){return{suit:6,value:e}})),{hand:[],piles:[]});return{deck:e,discards:[],players:[u({},n),u({},n)],playerIndex:0,phaseIndex:0}},m=function(e){var n=e.deck,r=e.players.map((function(e){var r=n.slice(0,8);return n=n.slice(8),u({},e,{hand:r})}));return u({},e,{deck:n,players:r})},h=function(e,n){var r=e.deck,t=e.discards,a=e.players.map((function(a,o){return o!==e.playerIndex?a:(n?(c=n,t=t.filter((function(e){return e!==n}))):(c=r[0],r=r.slice(1)),u({},a,{hand:s(a.hand).concat([c])}));var c})),o=(e.playerIndex+1)%e.players.length;return u({},e,{deck:r,players:a,discards:t,playerIndex:o,phaseIndex:0})},y=function(e,n){var r=s(e.discards).concat([n]),t=e.players.map((function(r,t){return t!==e.playerIndex?r:u({},r,{hand:r.hand.filter((function(e){return e!==n}))})}));return u({},e,{players:t,discards:r,phaseIndex:1})},x=function(e,n){var r=e.players.map((function(r,t){return t!==e.playerIndex?r:u({},r,{piles:s(r.piles).concat([n]),hand:r.hand.filter((function(e){return e!==n}))})}));return u({},e,{players:r,phaseIndex:1})},b=function(e){return Object.values((0,t.groupBy)(e,(function(e){return e.suit})))},j=0,I=function(){return g[j++]},g=o()(["Dayne","Golden","Chelsie","Elody","Corene","Katrine","Gregoria","Chelsey","Camille","Bernardo","Kristin","Ned","Oleta","Bernice","Melany","Nelle","Hardy","Myron","Jacey","Gilberto","Pattie","Lawrence","Alda","Jayme","Mable","Jerad","Kamron","Javonte","Lucie","Robin","Wilber","Dameon","Sigmund","Hayley","Ladarius","Lincoln","Wilford","Melvin","Buddy","Omari","Lafayette","Matilda","Federico","Fausto","Dexter","Boyd","Kim","Lance","Art","Kathryn"])},4293:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return m}});var t=r(5893),a=r(7294),o=r(9898),c=r(1641),i=function(e){var n=e.room,r=e.onLeave,o=(0,a.useState)(null),i=o[0],u=o[1],s=(0,a.useState)(null),l=s[0],d=s[1];(0,a.useEffect)((function(){n.onStateChange((function(e){u(e.toJSON())})),n.onLeave((function(e){console.warn({type:"leave",code:e}),r()})),n.onError((function(e,n){console.error({type:"error",code:e,error:n}),r()}))}),[n,r]);return-1===(null===i||void 0===i?void 0:i.playerIndex)?(0,t.jsxs)("div",{children:[i.players.map((function(e){return(0,t.jsx)("p",{children:e.name},e.name)})),(0,t.jsx)("button",{onClick:function(){return n.send("Start")},children:"start"})]}):(0,t.jsx)(c.Ar,{state:i,currentPlayerId:n.sessionId,selectedCard:l,onSelect:function(e){i&&1!==i.phaseIndex&&d(l===e?null:e)},onDiscard:function(){i&&1!==i.phaseIndex&&l&&(d(null),n.send("Discard",{card:l}))},onDraw:function(e){i&&0!==i.phaseIndex&&n.send("Draw",{drawnCard:e})},onPlay:function(){i&&1!==i.phaseIndex&&l&&(d(null),n.send("Play",{card:l}))}})},u=r(4051),s=r.n(u),l=r(5830);function d(e,n,r,t,a,o,c){try{var i=e[o](c),u=i.value}catch(s){return void r(s)}i.done?n(u):Promise.resolve(u).then(t,a)}function f(e){return function(){var n=this,r=arguments;return new Promise((function(t,a){var o=e.apply(n,r);function c(e){d(o,t,a,c,i,"next",e)}function i(e){d(o,t,a,c,i,"throw",e)}c(void 0)}))}}var p=function(e){var n=e.colyseus,r=e.setRoom,o=(0,a.useRef)(),c=(0,a.useRef)(!1),i=(0,a.useState)([]),u=i[0],d=i[1],p=(0,a.useCallback)(f(s().mark((function e(){var r,t;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="Game"+Date.now(),e.next=3,n.create("game",{roomName:r,name:(0,l.oY)()});case 3:return t=e.sent,localStorage.setItem(t.id,t.sessionId),e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)}))),[n]),v=(0,a.useCallback)(function(){var e=f(s().mark((function e(r,t){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=localStorage.getItem(r))){e.next=13;break}return e.prev=2,e.next=5,n.reconnect(r,o);case 5:a=e.sent,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.error(e.t0);case 11:e.next=19;break;case 13:if(e.t1=a,e.t1){e.next=18;break}return e.next=17,n.joinById(r,{name:t});case 17:e.t1=e.sent;case 18:a=e.t1;case 19:return e.abrupt("return",a);case 20:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(n,r){return e.apply(this,arguments)}}(),[n]),m=(0,a.useCallback)(function(){var e=f(s().mark((function e(n,r,t){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(n,r);case 3:if(a=e.sent){e.next=6;break}throw new Error("Failed to join room");case 6:return localStorage.setItem(a.id,a.sessionId),t(a),e.abrupt("return",a);case 11:e.prev=11,e.t0=e.catch(0),alert(e.t0),localStorage.removeItem(n);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,r,t){return e.apply(this,arguments)}}(),[v]),h=(0,a.useCallback)((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,l.oY)();return m(e,n,(function(e){return r(e)}))}),[m,r]);return(0,a.useEffect)((function(){if(n){var e=function(){var e=f(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getAvailableRooms();case 2:if(0!==(r=e.sent).length){e.next=5;break}return e.abrupt("return");case 5:localStorage.getItem(r[0].roomId)||h(r[0].roomId),d(r);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.current=setInterval(e,500),function(){o.current&&clearInterval(o.current)}}}),[n,h]),(0,a.useEffect)((function(){if(u){var e=u.find((function(e){return localStorage.getItem(e.roomId)}));e&&!c.current&&(c.current=!0,h(e.roomId))}}),[u,h]),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{children:"Game"}),u.map((function(e){var n;return(0,t.jsx)("div",{onClick:function(){return h(e.roomId)},children:(null===(n=e.metadata)||void 0===n?void 0:n.roomName)||e.roomId},e.roomId)})),(0,t.jsx)("button",{onClick:function(){p().then((function(e){e&&r(e)}))},children:"Create Room"})]})},v=new o.Client("wss://online-keltis.herokuapp.com"),m=function(){var e=(0,a.useState)(null),n=e[0],r=e[1];return n?(0,t.jsx)(i,{room:n,onLeave:function(){return r(null)}}):(0,t.jsx)(p,{colyseus:v,setRoom:r})}}},function(e){e.O(0,[662,53,301,774,888,179],(function(){return n=5301,e(e.s=n);var n}));var n=e.O();_N_E=n}]);